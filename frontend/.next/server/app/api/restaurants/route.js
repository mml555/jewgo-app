"use strict";(()=>{var e={};e.id=854,e.ids=[854],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},47638:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>m,patchFetch:()=>y,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>h,staticGenerationAsyncStorage:()=>_});var s={};r.r(s),r.d(s,{GET:()=>g,POST:()=>u});var a=r(49303),n=r(88716),o=r(60670),i=r(87070),l=r(33393);let p=l.z.object({name:l.z.string().min(1,"Restaurant name is required").max(255),short_description:l.z.string().max(80,"Short description must be 80 characters or less"),description:l.z.string().optional(),certifying_agency:l.z.string().min(1,"Certifying agency is required"),kosher_category:l.z.enum(["meat","dairy","pareve"]),is_cholov_yisroel:l.z.boolean().optional(),is_pas_yisroel:l.z.boolean().optional(),kosher_cert_link:l.z.string().url().optional().or(l.z.literal("")),phone:l.z.string().min(1,"Phone number is required"),email:l.z.string().email().optional().or(l.z.literal("")),address:l.z.string().min(1,"Address is required"),website:l.z.string().url().optional().or(l.z.literal("")),google_listing_url:l.z.string().url().optional().or(l.z.literal("")),hours_open:l.z.string().min(1,"Hours are required"),price_range:l.z.string().optional(),image_url:l.z.string().url().optional().or(l.z.literal("")),category:l.z.string().default("restaurant"),user_type:l.z.enum(["owner","community"]),owner_info:l.z.object({name:l.z.string().optional(),email:l.z.string().email().optional(),phone:l.z.string().optional()}).optional()}).refine(e=>!("dairy"===e.kosher_category&&void 0===e.is_cholov_yisroel||["meat","pareve"].includes(e.kosher_category)&&void 0===e.is_pas_yisroel),{message:"Kosher subcategory is required",path:["kosher_category"]});async function u(e){try{let t=await e.json(),r=p.parse(t),s={name:r.name,short_description:r.short_description,description:r.description||null,certifying_agency:r.certifying_agency,kosher_category:r.kosher_category,is_cholov_yisroel:"dairy"===r.kosher_category?r.is_cholov_yisroel:null,is_pas_yisroel:["meat","pareve"].includes(r.kosher_category)?r.is_pas_yisroel:null,kosher_cert_link:r.kosher_cert_link||null,phone:r.phone,email:r.email||null,address:r.address,website:r.website||null,google_listing_url:r.google_listing_url||null,hours_open:r.hours_open,price_range:r.price_range||null,image_url:r.image_url||null,category:r.category,status:"pending_approval",created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return console.log("Restaurant submission:",s),i.NextResponse.json({success:!0,message:"Restaurant submitted successfully for review",data:{id:Math.floor(1e4*Math.random()),...s}},{status:201})}catch(e){if(console.error("Restaurant submission error:",e),e instanceof l.z.ZodError)return i.NextResponse.json({success:!1,message:"Validation failed",errors:e.issues},{status:400});return i.NextResponse.json({success:!1,message:"Internal server error"},{status:500})}}async function g(e){try{let{searchParams:t}=new URL(e.url),r=parseInt(t.get("limit")||"50"),s=parseInt(t.get("offset")||"0"),a=t.get("search"),n=t.get("city"),o=t.get("state"),l=t.get("certifying_agency"),p=t.get("kosher_category"),u=t.get("is_cholov_yisroel"),g=t.get("listing_type"),c=t.get("price_range"),d=t.get("min_rating"),_=t.get("has_reviews"),h=t.get("open_now"),m=t.get("status")||"active",y=t.get("lat"),f=t.get("lng"),z=t.get("radius"),v=new URLSearchParams;r&&v.append("limit",r.toString()),s&&v.append("offset",s.toString()),a&&v.append("query",a),n&&v.append("city",n),o&&v.append("state",o),l&&v.append("certifying_agency",l),p&&v.append("kosher_category",p),u&&v.append("is_cholov_yisroel",u),g&&v.append("listing_type",g),c&&v.append("price_range",c),d&&v.append("min_rating",d),_&&v.append("has_reviews",_),h&&v.append("open_now",h),m&&v.append("status",m),y&&v.append("lat",y),f&&v.append("lng",f),z&&v.append("radius",z);let w=`https://jewgo.onrender.com/api/restaurants?${v.toString()}`;console.log("Fetching restaurants from:",w);let k=await fetch(w,{method:"GET",headers:{"Content-Type":"application/json"}});if(!k.ok)throw Error(`Backend API error: ${k.status} ${k.statusText}`);let x=await k.json();return i.NextResponse.json({success:!0,data:x.restaurants||x.data||x,total:x.total||(x.restaurants?x.restaurants.length:x.data?x.data.length:0),limit:r,offset:s})}catch(e){return console.error("Error fetching restaurants:",e),i.NextResponse.json({success:!1,message:"Failed to fetch restaurants"},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/restaurants/route",pathname:"/api/restaurants",filename:"route",bundlePath:"app/api/restaurants/route"},resolvedPagePath:"/Users/mendell/jewgo app/frontend/app/api/restaurants/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:_,serverHooks:h}=c,m="/api/restaurants/route";function y(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:_})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[216,592],()=>r(47638));module.exports=s})();