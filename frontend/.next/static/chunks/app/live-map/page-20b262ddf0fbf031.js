(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[773],{2037:function(e,t,a){Promise.resolve().then(a.bind(a,7702))},7702:function(e,t,a){"use strict";a.d(t,{default:function(){return w}});var n=a(7437),o=a(2265),r=a(9376),l=a(4196),s=a(7144),i=a(5219),c=a(8809),d=a(257);function u(e){let{restaurants:t,onRestaurantSelect:a,selectedRestaurantId:r,userLocation:l,mapCenter:s,className:i="h-96"}=e,[u,g]=(0,o.useState)(!1),[m,p]=(0,o.useState)(null),[h,x]=(0,o.useState)(null),w=(0,o.useRef)(null),f=(0,o.useRef)(null),y=(0,o.useRef)([]),v=(0,o.useRef)(null),b=(0,o.useRef)(null),[L,j]=(0,o.useState)(!1),N=(0,c.qP)(t,e=>{if(!e.latitude||!e.longitude)return!1;let t=parseFloat(e.latitude.toString()),a=parseFloat(e.longitude.toString());return!isNaN(t)&&!isNaN(a)});console.log("InteractiveRestaurantMap Debug:",{totalRestaurants:t.length,restaurantsWithCoords:N.length,userLocation:!!l,mapCenter:!!s}),(0,o.useEffect)(()=>{(()=>{if(window.google&&window.google.maps&&window.google.maps.LatLngBounds){j(!0);return}if(document.querySelector('script[src*="maps.googleapis.com"]')){let e=setInterval(()=>{window.google&&window.google.maps&&window.google.maps.LatLngBounds&&(j(!0),clearInterval(e))},100);setTimeout(()=>{clearInterval(e),window.google&&window.google.maps||p("Google Maps API failed to load")},1e4);return}let e=document.createElement("script");e.src="https://maps.googleapis.com/maps/api/js?key=".concat(d.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY,"&libraries=places,geometry&loading=async"),e.async=!0,e.defer=!0,e.onload=()=>{let e=setInterval(()=>{window.google&&window.google.maps&&window.google.maps.LatLngBounds&&(j(!0),clearInterval(e))},100);setTimeout(()=>{clearInterval(e),window.google&&window.google.maps||p("Google Maps API failed to initialize")},1e4)},e.onerror=()=>{p("Failed to load Google Maps API")},document.head.appendChild(e)})()},[]),(0,o.useEffect)(()=>{if(L&&w.current&&!m)try{if(!window.google||!window.google.maps||!window.google.maps.LatLngBounds){console.error("Google Maps API not fully loaded"),p("Google Maps API not fully loaded");return}if(!f.current){let e=new window.google.maps.LatLngBounds,t={lat:25.7617,lng:-80.1918};l&&(t={lat:l.latitude,lng:l.longitude},e.extend(new window.google.maps.LatLng(l.latitude,l.longitude))),N.length>0&&N.forEach(t=>{void 0!==t.latitude&&void 0!==t.longitude&&e.extend(new window.google.maps.LatLng(t.latitude,t.longitude))});let a=new window.google.maps.Map(w.current,{center:t,zoom:l?14:10,mapTypeId:window.google.maps.MapTypeId.ROADMAP,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"simplified"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"simplified"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#e3f2fd"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#e8f5e8"}]}],zoomControl:!0,mapTypeControl:!1,scaleControl:!0,streetViewControl:!1,rotateControl:!1,fullscreenControl:!0,gestureHandling:"cooperative"});f.current=a,b.current=new window.google.maps.InfoWindow({disableAutoPan:!1,maxWidth:300}),s?(a.setCenter(s),a.setZoom(16)):l?(a.setCenter({lat:l.latitude,lng:l.longitude}),a.setZoom(14)):N.length>0&&a.fitBounds(e),g(!0)}}catch(e){console.error("Error initializing map:",e),p("Failed to initialize map")}},[L,m,l,s]),(0,o.useEffect)(()=>{if(f.current&&u&&l)try{let e=f.current;v.current&&v.current.setMap(null);let t=new window.google.maps.LatLng(l.latitude,l.longitude),a={url:"data:image/svg+xml;charset=UTF-8,".concat(encodeURIComponent('\n          <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <circle cx="16" cy="16" r="8" fill="#4285F4" stroke="white" stroke-width="3"/>\n            <circle cx="16" cy="16" r="4" fill="white"/>\n            <circle cx="16" cy="16" r="12" fill="#4285F4" opacity="0.3"/>\n          </svg>\n        ')),scaledSize:new window.google.maps.Size(32,32),anchor:new window.google.maps.Point(16,16)};v.current=new window.google.maps.Marker({position:t,map:e,icon:a,title:"Your Location",zIndex:1e3}),v.current.addListener("click",()=>{if(e.panTo(t),e.setZoom(10),b.current){let t='\n            <div class="p-3 max-w-xs">\n              <div class="flex items-center space-x-2">\n                <div class="w-3 h-3 bg-blue-500 rounded-full"></div>\n                <h3 class="font-semibold text-gray-900 text-sm">Your Location</h3>\n              </div>\n              <p class="text-gray-600 text-xs mt-1">\n                '.concat(l.latitude.toFixed(6),", ").concat(l.longitude.toFixed(6),"\n              </p>\n              ").concat(l.accuracy?'\n                <p class="text-gray-500 text-xs mt-1">\n                  Accuracy: \xb1'.concat(Math.round(l.accuracy)," meters\n                </p>\n              "):"","\n            </div>\n          ");b.current.setContent(t),b.current.open(e,v.current)}})}catch(e){console.error("Error updating user location marker:",e)}},[l,u]),(0,o.useEffect)(()=>{if(f.current&&u&&l)try{let e=f.current;console.log("Updating map center to user location:",l),e.panTo({lat:l.latitude,lng:l.longitude}),e.setZoom(14)}catch(e){console.error("Error updating map center:",e)}},[l,u]),(0,o.useEffect)(()=>{if(console.log("mapCenter prop changed:",s),console.log("mapLoaded:",u),console.log("mapInstanceRef.current:",!!f.current),!f.current||!u||!s){console.log("Skipping map center update - conditions not met");return}try{let e=f.current;console.log("Updating map center from URL parameters:",s),e.panTo(s),e.setZoom(16),console.log("Map center updated successfully")}catch(e){console.error("Error updating map center from URL parameters:",e)}},[s,u]),(0,o.useEffect)(()=>{if(f.current&&u&&0!==N.length)try{let e=f.current;y.current.forEach(e=>e.setMap(null)),y.current=[],N.forEach(t=>{let n;if(void 0===t.latitude||void 0===t.longitude)return;let o=new window.google.maps.LatLng(t.latitude,t.longitude),s=r===t.id,i=null;if(l){let e=(t.latitude-l.latitude)*Math.PI/180,a=(t.longitude-l.longitude)*Math.PI/180,n=Math.sin(e/2)*Math.sin(e/2)+Math.cos(l.latitude*Math.PI/180)*Math.cos(t.latitude*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);i=2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n))*3959}let c=(e=>{switch(null==e?void 0:e.toLowerCase()){case"meat":return"#dc2626";case"dairy":return"#2563eb";case"pareve":return"#059669";default:return"#4b5563"}})(t.kosher_category),d=s?"#FFD700":c;if(window.google.maps.marker&&window.google.maps.marker.AdvancedMarkerElement)try{let a=new window.google.maps.marker.PinElement({background:d,borderColor:"#000000",glyphColor:"#FFFFFF",scale:1.5});n=new window.google.maps.marker.AdvancedMarkerElement({position:o,map:e,content:a.element,title:t.name})}catch(r){console.warn("AdvancedMarkerElement failed, falling back to regular Marker:",r);let a={url:"data:image/svg+xml;charset=UTF-8,".concat(encodeURIComponent('\n                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                  <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z" \n                        fill="'.concat(d,'" \n                        stroke="#000000" \n                        stroke-width="1.5"/>\n                  <circle cx="12" cy="9" r="2.5" fill="white"/>\n                  <circle cx="12" cy="9" r="1.5" fill="').concat(d,'"/>\n                </svg>\n              '))),scaledSize:new window.google.maps.Size(32,32),anchor:new window.google.maps.Point(12,24)};n=new window.google.maps.Marker({position:o,map:e,icon:a,title:t.name})}else{let a={url:"data:image/svg+xml;charset=UTF-8,".concat(encodeURIComponent('\n              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z" \n                      fill="'.concat(d,'" \n                      stroke="#000000" \n                      stroke-width="1.5"/>\n                <circle cx="12" cy="9" r="2.5" fill="white"/>\n                <circle cx="12" cy="9" r="1.5" fill="').concat(d,'"/>\n              </svg>\n            '))),scaledSize:new window.google.maps.Size(32,32),anchor:new window.google.maps.Point(12,24)};n=new window.google.maps.Marker({position:o,map:e,icon:a,title:t.name})}n.addListener("click",()=>{if(console.log("Marker clicked:",t.name),x(t),null==a||a(t.id),b.current){let a=k(t,i);b.current.setContent(a),b.current.open(e,n)}}),y.current.push(n)})}catch(e){console.error("Error updating markers:",e)}},[N,r,u,l]);let M=e=>{var t;if(null===(t=e.image_url)||void 0===t?void 0:t.includes("maps.googleapis.com/maps/api/place/photo")){let t=d.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY;if(t&&"YOUR_API_KEY_HERE"!==t)try{let a=new URL(e.image_url),n=a.searchParams.get("photo_reference"),o=a.searchParams.get("maxwidth")||"400";if(n)return"https://maps.googleapis.com/maps/api/place/photo?maxwidth=".concat(o,"&photo_reference=").concat(n,"&key=").concat(t)}catch(e){console.error("Error parsing Google Places URL:",e)}return null}return e.image_url},k=(e,t)=>{let a=M(e);return'\n      <div class="p-3 max-w-xs relative">\n        <button onclick="this.parentElement.parentElement.parentElement.close()" \n                class="absolute top-2 right-2 text-gray-400 hover:text-gray-600 text-lg font-bold leading-none">\n          \xd7\n        </button>\n        <div class="flex items-start space-x-3">\n          '.concat(a?'\n            <img src="'.concat(a,'" alt="').concat(e.name,'" \n                 class="w-16 h-12 object-cover rounded-lg flex-shrink-0"\n                 loading="lazy" />\n          '):'\n            <div class="w-16 h-12 bg-gray-200 rounded-lg flex-shrink-0 flex items-center justify-center">\n              <span class="text-gray-400 text-xs">No Image</span>\n            </div>\n          ','\n          <div class="flex-1 min-w-0">\n            <h3 class="font-semibold text-gray-900 text-sm leading-tight mb-1">').concat(e.name,'</h3>\n            <p class="text-gray-600 text-xs mb-1">').concat(e.address,"</p>\n            ").concat(null!=t?'\n              <p class="text-blue-600 text-xs font-medium mb-1">\uD83D\uDCCD '.concat(t.toFixed(1)," miles away</p>\n            "):"","\n            ").concat(e.certifying_agency?'\n              <span class="inline-block bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded-full mb-1">\n                '.concat(e.certifying_agency,"\n              </span>\n            "):"","\n            ").concat(e.kosher_category?'\n              <span class="inline-block '.concat("meat"===e.kosher_category?"bg-red-50 text-red-900 border border-red-200":"dairy"===e.kosher_category?"bg-blue-50 text-blue-900 border border-blue-200":"pareve"===e.kosher_category?"bg-yellow-50 text-yellow-900 border border-yellow-200":"bg-gray-100 text-gray-800",' text-xs px-2 py-1 rounded-full mb-1">\n                ').concat(e.kosher_category,"\n              </span>\n            "):"","\n            ").concat(e.avg_price?'\n              <p class="text-green-600 text-xs font-medium">'.concat(e.avg_price,"</p>\n            "):"",'\n          </div>\n        </div>\n        <div class="mt-3 pt-2 border-t border-gray-200">\n          <a href="/restaurant/').concat(e.id,'" \n             class="text-blue-600 hover:text-blue-800 text-xs font-medium">\n            View Details →\n          </a>\n        </div>\n      </div>\n    ')};return L||m?m?(0,n.jsx)("div",{className:"bg-gray-100 rounded-lg flex items-center justify-center ".concat(i),children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-red-500 text-4xl mb-4",children:"⚠️"}),(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Map Error"}),(0,n.jsx)("p",{className:"text-gray-600 mb-4",children:m})]})}):0===N.length?(0,n.jsx)("div",{className:"bg-gray-100 rounded-lg flex items-center justify-center ".concat(i),children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-gray-400 text-4xl mb-4",children:"\uD83D\uDDFA️"}),(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Location Data"}),(0,n.jsx)("p",{className:"text-gray-600",children:"No restaurants with location data available"})]})}):(0,n.jsxs)("div",{className:"relative bg-white rounded-lg shadow-lg overflow-hidden ".concat(i),children:[(0,n.jsx)("div",{ref:w,className:"w-full h-full"}),(0,n.jsx)("div",{className:"absolute bottom-4 left-4 bg-white/95 backdrop-blur-sm rounded-lg px-3 py-2 shadow-lg",children:(0,n.jsxs)("div",{className:"text-xs font-medium text-gray-700",children:[N.length," restaurants",l&&(0,n.jsx)("span",{className:"text-blue-600 ml-2",children:"\uD83D\uDCCD Your location"})]})}),(0,n.jsxs)("div",{className:"absolute top-4 left-4 bg-white/95 backdrop-blur-sm rounded-lg px-3 py-2 shadow-lg",children:[(0,n.jsx)("div",{className:"text-xs font-medium text-gray-700 mb-2",children:"Kosher Types:"}),(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500"}),(0,n.jsx)("span",{className:"text-xs text-gray-600",children:"Meat"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),(0,n.jsx)("span",{className:"text-xs text-gray-600",children:"Dairy"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-500"}),(0,n.jsx)("span",{className:"text-xs text-gray-600",children:"Pareve"})]})]})]}),l&&(0,n.jsx)("div",{className:"absolute top-4 right-4",children:(0,n.jsx)("button",{onClick:()=>{f.current&&l&&(f.current.panTo(new window.google.maps.LatLng(l.latitude,l.longitude)),f.current.setZoom(10))},className:"bg-white/95 backdrop-blur-sm rounded-lg p-2 shadow-lg hover:bg-white transition-colors",title:"Center on your location",children:(0,n.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})})})})]}):(0,n.jsx)("div",{className:"bg-gray-100 rounded-lg flex items-center justify-center ".concat(i),children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-jewgo-primary mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Loading interactive map..."})]})})}var g=a(4950),m=a(3097),p=a(5699),h=a(8850),x=a(2535);function w(){let e=(0,r.useSearchParams)(),[t,a]=(0,o.useState)([]),[d,w]=(0,o.useState)([]),[f,y]=(0,o.useState)(!0),[v,b]=(0,o.useState)(null),[L,j]=(0,o.useState)(""),[N,M]=(0,o.useState)(null),[k,C]=(0,o.useState)(null),[P,I]=(0,o.useState)(!1),[E,S]=(0,o.useState)(null),[_,A]=(0,o.useState)({}),[R,F]=(0,o.useState)(null),[T,D]=(0,o.useState)("eatery"),[U,z]=(0,o.useState)(!1),[G,q]=(0,o.useState)(!1),[Z,B]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let t=null==e?void 0:e.get("lat"),a=null==e?void 0:e.get("lng"),n=null==e?void 0:e.get("name");if(t&&a){let e=parseFloat(t),o=parseFloat(a);!isNaN(e)&&!isNaN(o)&&e>=-90&&e<=90&&o>=-180&&o<=180?(F({lat:e,lng:o}),n&&j(decodeURIComponent(n))):console.warn("Invalid coordinates in URL parameters:",{lat:t,lng:a,latitude:e,longitude:o})}},[e]),(0,o.useEffect)(()=>{B(!0)},[]),(0,o.useEffect)(()=>{Z&&(async()=>{if(!navigator.geolocation){console.log("Geolocation not supported");return}let e=localStorage.getItem("userLocation"),t=localStorage.getItem("locationPermissionHandled");k||e||t||G||(z(!0),q(!0))})()},[Z,k,G]),(0,o.useEffect)(()=>{Z&&O()},[Z]),(0,o.useEffect)(()=>{H()},[]),(0,o.useEffect)(()=>{k&&O()},[k]),(0,o.useEffect)(()=>{console.log("Live map useEffect triggered - updateDisplayedRestaurants"),console.log("Live map allRestaurants count:",t.length),console.log("searchQuery:",L),console.log("activeFilters:",_),console.log("userLocation:",k);let e=[...t];if(L.trim()){let t=L.toLowerCase().trim();e=(0,c.qP)(e,e=>{var a,n,o,r,l,s;return!!(null===(a=e.name)||void 0===a?void 0:a.toLowerCase().includes(t))||!!(null===(n=e.address)||void 0===n?void 0:n.toLowerCase().includes(t))||!!(null===(o=e.city)||void 0===o?void 0:o.toLowerCase().includes(t))||!!(null===(r=e.state)||void 0===r?void 0:r.toLowerCase().includes(t))||!!(null===(l=e.listing_type)||void 0===l?void 0:l.toLowerCase().includes(t))||!!(null===(s=e.certifying_agency)||void 0===s?void 0:s.toLowerCase().includes(t))})}if(_.agency&&(e=(0,c.qP)(e,e=>{var t;return!!(null===(t=e.certifying_agency)||void 0===t?void 0:t.toLowerCase().includes(_.agency.toLowerCase()))})),_.dietary&&(e=(0,c.qP)(e,e=>{var t;let a=(null===(t=e.kosher_category)||void 0===t?void 0:t.toLowerCase())||"";switch(_.dietary){case"meat":return"meat"===a;case"dairy":return"dairy"===a;case"pareve":return"pareve"===a;default:return!0}})),_.category&&(e=(0,c.qP)(e,e=>{var t;return!!(null===(t=e.listing_type)||void 0===t?void 0:t.toLowerCase().includes(_.category.toLowerCase()))})),_.nearMe&&k){let t=_.distanceRadius||10;e=(0,c.qP)(e,e=>!!e.latitude&&!!e.longitude&&K(k.latitude,k.longitude,e.latitude,e.longitude)<=t)}if(_.openNow){let t=new Date,a=t.toLocaleDateString("en-US",{weekday:"long"}).toLowerCase(),n=60*t.getHours()+t.getMinutes();e=(0,c.qP)(e,e=>{if(!e.hours_of_operation)return!1;try{let t="string"==typeof e.hours_of_operation?JSON.parse(e.hours_of_operation):e.hours_of_operation;if(!Array.isArray(t))return!1;let o=t.find(e=>e.day===a);if(!o)return!1;let r=W(o.open),l=W(o.close);if(-1===r||-1===l)return!1;if(l<r)return n>=r||n<=l;return n>=r&&n<=l}catch(t){return console.error("Error parsing hours for restaurant:",e.name,t),!1}})}k&&e.sort((e,t)=>e.latitude&&e.longitude?t.latitude&&t.longitude?K(k.latitude,k.longitude,e.latitude,e.longitude)-K(k.latitude,k.longitude,t.latitude,t.longitude):-1:1),console.log("Filtered restaurants count:",e.length),w(e)},[t,L,_,k]);let O=(0,o.useCallback)(async()=>{try{var e;y(!0),b(null),console.log("Live map fetching restaurants...");let t=await (0,x.Nx)(1e3);if(console.log("Live map restaurants fetched:",(null===(e=t.restaurants)||void 0===e?void 0:e.length)||0),t&&t.restaurants&&Array.isArray(t.restaurants)&&t.restaurants.length>0){let e=t.restaurants.filter(e=>e&&"object"==typeof e&&e.id);e.length!==t.restaurants.length&&console.warn("Live map filtered out ".concat(t.restaurants.length-e.length," invalid restaurants from API response")),a(e)}else console.warn("Live map no valid restaurants received from API, using mock data"),a((0,x.g)()),b("Using fallback data - API temporarily unavailable")}catch(e){console.error("Live map error fetching restaurants:",e),console.log("Live map falling back to mock data"),a((0,x.g)()),b("Using fallback data - API temporarily unavailable")}finally{y(!1)}},[]),H=()=>{if(!navigator.geolocation){S("Geolocation is not supported by this browser.");return}I(!0),S(null),navigator.geolocation.getCurrentPosition(e=>{C({latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy}),I(!1)},e=>{S(Y(e.code)),I(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})},Y=e=>{switch(e){case 1:return"Location access denied. Please enable location services.";case 2:return"Location unavailable. Please try again.";case 3:return"Location request timed out. Please try again.";default:return"Unable to get your location. Please try again."}},K=(e,t,a,n)=>{let o=(a-e)*Math.PI/180,r=(n-t)*Math.PI/180,l=Math.sin(o/2)*Math.sin(o/2)+Math.cos(e*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))*3959},W=e=>{let t=e.toLowerCase().trim().match(/(\d+):?(\d*)\s*(am|pm)/);if(!t)return -1;let a=parseInt(t[1]),n=t[2]?parseInt(t[2]):0,o=t[3];return"pm"===o&&12!==a&&(a+=12),"am"===o&&12===a&&(a=0),60*a+n},J=()=>{j(""),A({})},V=()=>!!L.trim()||Object.values(_).some(e=>void 0!==e&&!1!==e&&""!==e);return f?(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,n.jsx)("div",{className:"text-gray-500",children:"Loading restaurants..."})}):v?(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-red-500",children:["Error: ",v]})}):(0,n.jsxs)("div",{className:"min-h-screen bg-neutral-50",children:[(0,n.jsx)(l.Z,{}),(0,n.jsx)("div",{className:"px-4 sm:px-6 py-4 bg-white border-b border-gray-100",children:(0,n.jsx)(s.Z,{onSearch:e=>{j(e)},onResultsUpdate:e=>{console.log("Enhanced search results:",e.length,"restaurants"),w(e)}})}),(0,n.jsx)("div",{className:"px-4 sm:px-6 py-3 bg-white border-b border-gray-100",children:(0,n.jsx)(i.Z,{onShowFilters:()=>{},onShowMap:()=>{},onAddEatery:()=>window.location.href="/add-eatery",onFilterChange:(e,t)=>{A(a=>({...a,[e]:t}))},onToggleFilter:(e,t)=>{A(a=>({...a,[e]:t}))},onDistanceChange:e=>{A(t=>({...t,distanceRadius:e}))},onClearAll:J,onLocationReset:()=>{console.log("Resetting location permission"),localStorage.removeItem("userLocation"),localStorage.removeItem("locationPermissionHandled"),C(null),S(null),q(!1),z(!0)},activeFilters:_,userLocation:k?{lat:k.latitude,lng:k.longitude}:null,locationLoading:P,hasActiveFilters:V(),isOnMapPage:!0})}),(0,n.jsx)("div",{className:"px-4 sm:px-6 py-2 bg-white border-b border-gray-100",children:(0,n.jsx)(m.Z,{activeTab:T,onTabChange:e=>{D(e)}})}),P&&(0,n.jsx)("div",{className:"px-4 py-2 bg-blue-50 text-blue-700 text-sm",children:"Getting your location..."}),E&&(0,n.jsxs)("div",{className:"px-4 py-2 bg-yellow-50 text-yellow-700 text-sm",children:[E,(0,n.jsx)("button",{onClick:H,className:"ml-2 underline hover:no-underline",children:"Try again"})]}),V()&&(0,n.jsxs)("div",{className:"px-4 py-2 bg-gray-50 text-sm text-gray-600 border-b border-gray-200",children:[(()=>{let e=[];return L.trim()&&e.push('"'.concat(L,'"')),_.agency&&e.push("".concat(_.agency," certified")),_.dietary&&e.push("".concat(_.dietary," only")),_.category&&e.push("".concat(_.category," cuisine")),_.nearMe&&e.push("within ".concat(_.distanceRadius||10," miles")),_.openNow&&e.push("open now"),e.length>0?e.join(", "):"All restaurants"})()," • ",d.length," restaurants",(0,n.jsx)("button",{onClick:J,className:"ml-2 text-blue-600 hover:text-blue-800 underline",children:"Clear all"})]}),(0,n.jsx)("div",{className:"flex-1 relative",children:(0,n.jsx)(u,{restaurants:d,userLocation:k,selectedRestaurantId:null==N?void 0:N.id,onRestaurantSelect:e=>{M(t.find(t=>t.id===e)||null)},mapCenter:R})}),(0,n.jsx)(g.Z,{}),(0,n.jsx)(h.Z,{}),U&&(0,n.jsx)(p.Z,{onLocationGranted:e=>{console.log("Location granted:",e),C(e),z(!1),localStorage.setItem("userLocation",JSON.stringify(e)),localStorage.setItem("locationPermissionHandled","granted")},onLocationDenied:()=>{console.log("Location denied by user"),z(!1),S("Location access denied"),localStorage.setItem("locationPermissionHandled","denied")},onDismiss:()=>{console.log("Location prompt dismissed"),z(!1),localStorage.setItem("locationPermissionHandled","dismissed")}})]})}}},function(e){e.O(0,[216,592,744],function(){return e(e.s=2037)}),_N_E=e.O()}]);