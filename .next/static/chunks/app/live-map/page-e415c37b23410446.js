(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[773],{5369:function(e,t,a){Promise.resolve().then(a.bind(a,8991))},8991:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return LiveMapPage}});var n=a(7437),r=a(2265),o=a(4033),s=a(3827),l=a(7189),i=a(9968);function InteractiveRestaurantMap(e){let{restaurants:t,onRestaurantSelect:a,selectedRestaurantId:o,userLocation:s,mapCenter:l,className:i="h-96"}=e,[c,d]=(0,r.useState)(!1),[u,g]=(0,r.useState)(null),[m,p]=(0,r.useState)(null),h=(0,r.useRef)(null),x=(0,r.useRef)(null),w=(0,r.useRef)([]),f=(0,r.useRef)(null),y=(0,r.useRef)(null),[v,b]=(0,r.useState)(!1),j=t.filter(e=>{if(!e.latitude||!e.longitude)return!1;let t=parseFloat(e.latitude.toString()),a=parseFloat(e.longitude.toString());return!(isNaN(t)||isNaN(a))&&(0!==t||0!==a)&&!(t<-90)&&!(t>90)&&!(a<-180)&&!(a>180)});console.log("InteractiveRestaurantMap Debug:",{totalRestaurants:t.length,restaurantsWithCoords:j.length,userLocation:!!s,mapCenter:!!l}),(0,r.useEffect)(()=>{(()=>{if(window.google&&window.google.maps&&window.google.maps.LatLngBounds){b(!0);return}if(document.querySelector('script[src*="maps.googleapis.com"]')){let e=setInterval(()=>{window.google&&window.google.maps&&window.google.maps.LatLngBounds&&(b(!0),clearInterval(e))},100);setTimeout(()=>{clearInterval(e),window.google&&window.google.maps||g("Google Maps API failed to load")},1e4);return}let e=document.createElement("script");e.src="https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyA12xiUBIe9EJmuP8pEmWgj_Fsv0FkUiqA","&libraries=places,geometry&loading=async"),e.async=!0,e.defer=!0,e.onload=()=>{let e=setInterval(()=>{window.google&&window.google.maps&&window.google.maps.LatLngBounds&&(b(!0),clearInterval(e))},100);setTimeout(()=>{clearInterval(e),window.google&&window.google.maps||g("Google Maps API failed to initialize")},1e4)},e.onerror=()=>{g("Failed to load Google Maps API")},document.head.appendChild(e)})()},[]),(0,r.useEffect)(()=>{if(v&&h.current&&!u)try{if(!window.google||!window.google.maps||!window.google.maps.LatLngBounds){console.error("Google Maps API not fully loaded"),g("Google Maps API not fully loaded");return}if(!x.current){let e=new window.google.maps.LatLngBounds,t={lat:25.7617,lng:-80.1918};s&&(t={lat:s.latitude,lng:s.longitude},e.extend(new window.google.maps.LatLng(s.latitude,s.longitude))),j.length>0&&j.forEach(t=>{void 0!==t.latitude&&void 0!==t.longitude&&e.extend(new window.google.maps.LatLng(t.latitude,t.longitude))});let a=new window.google.maps.Map(h.current,{center:t,zoom:s?14:10,mapTypeId:window.google.maps.MapTypeId.ROADMAP,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"simplified"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"simplified"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#e3f2fd"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#e8f5e8"}]}],zoomControl:!0,mapTypeControl:!1,scaleControl:!0,streetViewControl:!1,rotateControl:!1,fullscreenControl:!0,gestureHandling:"cooperative"});x.current=a,y.current=new window.google.maps.InfoWindow({disableAutoPan:!1,maxWidth:300}),l?(a.setCenter(l),a.setZoom(16)):s?(a.setCenter({lat:s.latitude,lng:s.longitude}),a.setZoom(14)):j.length>0&&a.fitBounds(e),d(!0)}}catch(e){console.error("Error initializing map:",e),g("Failed to initialize map")}},[v,u,s,l]),(0,r.useEffect)(()=>{if(x.current&&c&&s)try{let e=x.current;f.current&&f.current.setMap(null);let t=new window.google.maps.LatLng(s.latitude,s.longitude),a={url:"data:image/svg+xml;charset=UTF-8,".concat(encodeURIComponent('\n          <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <circle cx="16" cy="16" r="8" fill="#4285F4" stroke="white" stroke-width="3"/>\n            <circle cx="16" cy="16" r="4" fill="white"/>\n            <circle cx="16" cy="16" r="12" fill="#4285F4" opacity="0.3"/>\n          </svg>\n        ')),scaledSize:new window.google.maps.Size(32,32),anchor:new window.google.maps.Point(16,16)};f.current=new window.google.maps.Marker({position:t,map:e,icon:a,title:"Your Location",zIndex:1e3}),f.current.addListener("click",()=>{if(e.panTo(t),e.setZoom(10),y.current){let t='\n            <div class="p-3 max-w-xs">\n              <div class="flex items-center space-x-2">\n                <div class="w-3 h-3 bg-blue-500 rounded-full"></div>\n                <h3 class="font-semibold text-gray-900 text-sm">Your Location</h3>\n              </div>\n              <p class="text-gray-600 text-xs mt-1">\n                '.concat(s.latitude.toFixed(6),", ").concat(s.longitude.toFixed(6),"\n              </p>\n              ").concat(s.accuracy?'\n                <p class="text-gray-500 text-xs mt-1">\n                  Accuracy: \xb1'.concat(Math.round(s.accuracy)," meters\n                </p>\n              "):"","\n            </div>\n          ");y.current.setContent(t),y.current.open(e,f.current)}})}catch(e){console.error("Error updating user location marker:",e)}},[s,c]),(0,r.useEffect)(()=>{if(x.current&&c&&s)try{let e=x.current;console.log("Updating map center to user location:",s),e.panTo({lat:s.latitude,lng:s.longitude}),e.setZoom(14)}catch(e){console.error("Error updating map center:",e)}},[s,c]),(0,r.useEffect)(()=>{if(console.log("mapCenter prop changed:",l),console.log("mapLoaded:",c),console.log("mapInstanceRef.current:",!!x.current),!x.current||!c||!l){console.log("Skipping map center update - conditions not met");return}try{let e=x.current;console.log("Updating map center from URL parameters:",l),e.panTo(l),e.setZoom(16),console.log("Map center updated successfully")}catch(e){console.error("Error updating map center from URL parameters:",e)}},[l,c]),(0,r.useEffect)(()=>{if(x.current&&c&&0!==j.length)try{let e=x.current;w.current.forEach(e=>e.setMap(null)),w.current=[],j.forEach(t=>{let n;if(void 0===t.latitude||void 0===t.longitude)return;let r=new window.google.maps.LatLng(t.latitude,t.longitude),l=o===t.id,i=null;if(s){let e=(t.latitude-s.latitude)*Math.PI/180,a=(t.longitude-s.longitude)*Math.PI/180,n=Math.sin(e/2)*Math.sin(e/2)+Math.cos(s.latitude*Math.PI/180)*Math.cos(t.latitude*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);i=3959*(2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n)))}let c=(e=>{switch(null==e?void 0:e.toLowerCase()){case"meat":return"#dc2626";case"dairy":return"#2563eb";case"pareve":return"#059669";default:return"#4b5563"}})(t.kosher_category),d=l?"#FFD700":c;if(window.google.maps.marker&&window.google.maps.marker.AdvancedMarkerElement)try{let a=new window.google.maps.marker.PinElement({background:d,borderColor:"#000000",glyphColor:"#FFFFFF",scale:1.5});n=new window.google.maps.marker.AdvancedMarkerElement({position:r,map:e,content:a.element,title:t.name})}catch(o){console.warn("AdvancedMarkerElement failed, falling back to regular Marker:",o);let a={url:"data:image/svg+xml;charset=UTF-8,".concat(encodeURIComponent('\n                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                  <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z" \n                        fill="'.concat(d,'" \n                        stroke="#000000" \n                        stroke-width="1.5"/>\n                  <circle cx="12" cy="9" r="2.5" fill="white"/>\n                  <circle cx="12" cy="9" r="1.5" fill="').concat(d,'"/>\n                </svg>\n              '))),scaledSize:new window.google.maps.Size(32,32),anchor:new window.google.maps.Point(12,24)};n=new window.google.maps.Marker({position:r,map:e,icon:a,title:t.name})}else{let a={url:"data:image/svg+xml;charset=UTF-8,".concat(encodeURIComponent('\n              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z" \n                      fill="'.concat(d,'" \n                      stroke="#000000" \n                      stroke-width="1.5"/>\n                <circle cx="12" cy="9" r="2.5" fill="white"/>\n                <circle cx="12" cy="9" r="1.5" fill="').concat(d,'"/>\n              </svg>\n            '))),scaledSize:new window.google.maps.Size(32,32),anchor:new window.google.maps.Point(12,24)};n=new window.google.maps.Marker({position:r,map:e,icon:a,title:t.name})}n.addListener("click",()=>{if(console.log("Marker clicked:",t.name),p(t),null==a||a(t.id),y.current){let a=createInfoWindowContent(t,i);y.current.setContent(a),y.current.open(e,n)}}),w.current.push(n)})}catch(e){console.error("Error updating markers:",e)}},[j,o,c,s]);let getSafeImageUrl=e=>{var t;let a=null===(t=e.image_url)||void 0===t?void 0:t.includes("maps.googleapis.com/maps/api/place/photo");if(a){let t="AIzaSyA12xiUBIe9EJmuP8pEmWgj_Fsv0FkUiqA";if(t)try{let a=new URL(e.image_url),n=a.searchParams.get("photo_reference"),r=a.searchParams.get("maxwidth")||"400";if(n)return"https://maps.googleapis.com/maps/api/place/photo?maxwidth=".concat(r,"&photo_reference=").concat(n,"&key=").concat(t)}catch(e){console.error("Error parsing Google Places URL:",e)}return null}return e.image_url},createInfoWindowContent=(e,t)=>{let a=getSafeImageUrl(e);return'\n      <div class="p-3 max-w-xs relative">\n        <button onclick="this.parentElement.parentElement.parentElement.close()" \n                class="absolute top-2 right-2 text-gray-400 hover:text-gray-600 text-lg font-bold leading-none">\n          \xd7\n        </button>\n        <div class="flex items-start space-x-3">\n          '.concat(a?'\n            <img src="'.concat(a,'" alt="').concat(e.name,'" \n                 class="w-16 h-12 object-cover rounded-lg flex-shrink-0"\n                 loading="lazy" />\n          '):'\n            <div class="w-16 h-12 bg-gray-200 rounded-lg flex-shrink-0 flex items-center justify-center">\n              <span class="text-gray-400 text-xs">No Image</span>\n            </div>\n          ','\n          <div class="flex-1 min-w-0">\n            <h3 class="font-semibold text-gray-900 text-sm leading-tight mb-1">').concat(e.name,'</h3>\n            <p class="text-gray-600 text-xs mb-1">').concat(e.address,"</p>\n            ").concat(null!=t?'\n              <p class="text-blue-600 text-xs font-medium mb-1">\uD83D\uDCCD '.concat(t.toFixed(1)," miles away</p>\n            "):"","\n            ").concat(e.certifying_agency?'\n              <span class="inline-block bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded-full mb-1">\n                '.concat(e.certifying_agency,"\n              </span>\n            "):"","\n            ").concat(e.kosher_category?'\n              <span class="inline-block '.concat("meat"===e.kosher_category?"bg-red-100 text-red-800":"dairy"===e.kosher_category?"bg-blue-100 text-blue-800":"pareve"===e.kosher_category?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",' text-xs px-2 py-1 rounded-full mb-1">\n                ').concat(e.kosher_category,"\n              </span>\n            "):"","\n            ").concat(e.avg_price?'\n              <p class="text-green-600 text-xs font-medium">'.concat(e.avg_price,"</p>\n            "):"",'\n          </div>\n        </div>\n        <div class="mt-3 pt-2 border-t border-gray-200">\n          <a href="/restaurant/').concat(e.id,'" \n             class="text-blue-600 hover:text-blue-800 text-xs font-medium">\n            View Details →\n          </a>\n        </div>\n      </div>\n    ')};return v||u?u?(0,n.jsx)("div",{className:"bg-gray-100 rounded-lg flex items-center justify-center ".concat(i),children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-red-500 text-4xl mb-4",children:"⚠️"}),(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Map Error"}),(0,n.jsx)("p",{className:"text-gray-600 mb-4",children:u})]})}):0===j.length?(0,n.jsx)("div",{className:"bg-gray-100 rounded-lg flex items-center justify-center ".concat(i),children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-gray-400 text-4xl mb-4",children:"\uD83D\uDDFA️"}),(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Location Data"}),(0,n.jsx)("p",{className:"text-gray-600",children:"No restaurants with location data available"})]})}):(0,n.jsxs)("div",{className:"relative bg-white rounded-lg shadow-lg overflow-hidden ".concat(i),children:[(0,n.jsx)("div",{ref:h,className:"w-full h-full"}),(0,n.jsx)("div",{className:"absolute bottom-4 left-4 bg-white/95 backdrop-blur-sm rounded-lg px-3 py-2 shadow-lg",children:(0,n.jsxs)("div",{className:"text-xs font-medium text-gray-700",children:[j.length," restaurants",s&&(0,n.jsx)("span",{className:"text-blue-600 ml-2",children:"\uD83D\uDCCD Your location"})]})}),(0,n.jsxs)("div",{className:"absolute top-4 left-4 bg-white/95 backdrop-blur-sm rounded-lg px-3 py-2 shadow-lg",children:[(0,n.jsx)("div",{className:"text-xs font-medium text-gray-700 mb-2",children:"Kosher Types:"}),(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500"}),(0,n.jsx)("span",{className:"text-xs text-gray-600",children:"Meat"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),(0,n.jsx)("span",{className:"text-xs text-gray-600",children:"Dairy"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-500"}),(0,n.jsx)("span",{className:"text-xs text-gray-600",children:"Pareve"})]})]})]}),s&&(0,n.jsx)("div",{className:"absolute top-4 right-4",children:(0,n.jsx)("button",{onClick:()=>{x.current&&s&&(x.current.panTo(new window.google.maps.LatLng(s.latitude,s.longitude)),x.current.setZoom(10))},className:"bg-white/95 backdrop-blur-sm rounded-lg p-2 shadow-lg hover:bg-white transition-colors",title:"Center on your location",children:(0,n.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})})})})]}):(0,n.jsx)("div",{className:"bg-gray-100 rounded-lg flex items-center justify-center ".concat(i),children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-jewgo-primary mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Loading interactive map..."})]})})}var c=a(9884);function LiveMapPage(){let e=(0,o.useSearchParams)(),[t,a]=(0,r.useState)([]),[d,u]=(0,r.useState)([]),[g,m]=(0,r.useState)(!0),[p,h]=(0,r.useState)(null),[x,w]=(0,r.useState)(""),[f,y]=(0,r.useState)(null),[v,b]=(0,r.useState)(null),[j,L]=(0,r.useState)(!1),[N,M]=(0,r.useState)(null),[k,C]=(0,r.useState)({}),[F,E]=(0,r.useState)(null);(0,r.useEffect)(()=>{let t=e.get("lat"),a=e.get("lng"),n=e.get("name");if(t&&a){let e=parseFloat(t),r=parseFloat(a);if(!isNaN(e)&&!isNaN(r)&&e>=-90&&e<=90&&r>=-180&&r<=180){if(E({lat:e,lng:r}),n){let e=decodeURIComponent(n);w(e)}}else console.warn("Invalid coordinates in URL parameters:",{lat:t,lng:a,latitude:e,longitude:r})}},[e]),(0,r.useEffect)(()=>{getUserLocation()},[]),(0,r.useEffect)(()=>{v&&I()},[v]),(0,r.useEffect)(()=>{console.log("Live map useEffect triggered - updateDisplayedRestaurants"),console.log("Live map allRestaurants count:",t.length),updateDisplayedRestaurants()},[t,x,k,v]);let I=(0,r.useCallback)(async()=>{try{m(!0),h(null);let e="http://localhost:8081/api/restaurants";if(v){let t=x.trim()?"".concat(e,"?limit=1000"):"".concat(e,"?limit=200&lat=").concat(v.latitude,"&lng=").concat(v.longitude,"&radius=50");console.log("Live map fetching from:",t);let n=await fetch(t);if(!n.ok)throw Error("Failed to fetch restaurants");let r=await n.json();if(r.success&&r.restaurants)console.log("Live map API returned restaurants:",r.restaurants.length),console.log("Live map setting allRestaurants:",r.restaurants.length),a(r.restaurants);else throw Error(r.error||"Failed to fetch restaurants")}else{let t=await fetch("".concat(e,"?limit=1000"));if(!t.ok)throw Error("Failed to fetch restaurants");let n=await t.json();if(n.success&&n.restaurants)console.log("Live map API returned restaurants:",n.restaurants.length),console.log("Live map setting allRestaurants:",n.restaurants.length),a(n.restaurants);else throw Error(n.error||"Failed to fetch restaurants")}}catch(e){console.error("Error fetching restaurants:",e)}finally{m(!1)}},[v,x]),getUserLocation=()=>{if(!navigator.geolocation){M("Geolocation is not supported by this browser");return}L(!0),M(null),navigator.geolocation.getCurrentPosition(e=>{let t={latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy};b(t),L(!1)},e=>{let t=getLocationErrorMessage(e.code);M(t),L(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})},getLocationErrorMessage=e=>{switch(e){case 1:return"Location access denied. Please enable location services.";case 2:return"Location unavailable. Please try again.";case 3:return"Location request timed out. Please try again.";default:return"Unable to get your location. Please try again."}},calculateDistance=(e,t,a,n)=>{let r=(a-e)*Math.PI/180,o=(n-t)*Math.PI/180,s=Math.sin(r/2)*Math.sin(r/2)+Math.cos(e*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(o/2)*Math.sin(o/2);return 3959*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))},updateDisplayedRestaurants=()=>{console.log("Live map updateDisplayedRestaurants called with:",{allRestaurantsCount:t.length,searchQuery:x,activeFilters:k});let e=[...t];if(x.trim()){let a=x.toLowerCase();console.log("Live map search query:",a),console.log("Live map first few restaurant names:",t.slice(0,3).map(e=>e.name)),e=e.filter(e=>{let t=[e.name,e.address,e.city,e.state,e.certifying_agency,e.kosher_category,e.listing_type,e.phone_number,e.avg_price].filter(Boolean).map(e=>null==e?void 0:e.toLowerCase()),n=t.some(e=>null==e?void 0:e.includes(a));return(e.name.toLowerCase().includes("17")||e.name.toLowerCase().includes("restaurant"))&&console.log("Live map checking restaurant:",e.name,"matches:",n),n})}if(k.agency&&"all"!==k.agency&&(e=e.filter(e=>{var t,a;return"Diamond K"===k.agency?"Diamond K"===e.certifying_agency:(null===(t=e.certifying_agency)||void 0===t?void 0:t.toUpperCase())===(null===(a=k.agency)||void 0===a?void 0:a.toUpperCase())})),k.dietary&&(e=e.filter(e=>{var t;let a=(null===(t=e.kosher_category)||void 0===t?void 0:t.toLowerCase())||"";return"meat"===k.dietary?"meat"===a:"dairy"===k.dietary?"dairy"===a:"pareve"===k.dietary&&"pareve"===a})),k.category&&"all"!==k.category&&(e=e.filter(e=>{var t,a;let n=(null===(t=e.listing_type)||void 0===t?void 0:t.toLowerCase())||"";return n===(null===(a=k.category)||void 0===a?void 0:a.toLowerCase())})),k.distanceRadius&&v&&(e=e.filter(e=>{let t=calculateDistance(v.latitude,v.longitude,parseFloat(String(e.latitude)||"0"),parseFloat(String(e.longitude)||"0"));return t<=k.distanceRadius})),k.openNow){let t=new Date;t.getDay(),t.getHours(),t.getMinutes(),e=e.filter(e=>e.hours_of_operation&&""!==e.hours_of_operation.trim())}v&&e.sort((e,t)=>{let a=calculateDistance(v.latitude,v.longitude,parseFloat(String(e.latitude)||"0"),parseFloat(String(e.longitude)||"0")),n=calculateDistance(v.latitude,v.longitude,parseFloat(String(t.latitude)||"0"),parseFloat(String(t.longitude)||"0"));return a-n}),console.log("Live map setting displayedRestaurants:",e.length),u(e)},getFilterDescription=()=>{let e=[];return k.agency&&e.push(k.agency),k.dietary&&e.push(k.dietary),k.category&&e.push(k.category),k.openNow&&e.push("Open Now"),k.distanceRadius&&e.push("".concat(k.distanceRadius," miles")),x.trim()&&e.push('"'.concat(x,'"')),e.join(" + ")},S=d.length;return(0,n.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,n.jsx)(s.Z,{}),(0,n.jsx)("div",{className:"px-4 py-4",children:(0,n.jsx)(l.Z,{onSearch:e=>{w(e)}})}),(0,n.jsxs)("div",{className:"px-4 mb-3",children:[j&&(0,n.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-blue-600 bg-blue-50 px-3 py-2 rounded-lg",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),(0,n.jsx)("span",{children:"Getting your location..."})]}),N&&(0,n.jsxs)("div",{className:"flex items-center justify-between text-sm text-red-600 bg-red-50 px-3 py-2 rounded-lg",children:[(0,n.jsx)("span",{children:N}),(0,n.jsx)("button",{onClick:getUserLocation,className:"text-red-800 hover:text-red-900 font-medium",children:"Retry"})]}),v&&(0,n.jsx)("div",{className:"flex items-center justify-between text-sm text-green-600 bg-green-50 px-3 py-2 rounded-lg",children:(0,n.jsx)("span",{children:"\uD83D\uDCCD Location found! Showing nearby restaurants"})})]}),(0,n.jsx)(i.Z,{onShowFilters:()=>{},onShowMap:()=>{window.location.href="/"},onAddEatery:()=>{window.location.href="/add-eatery"},activeFilters:k,onFilterChange:(e,t)=>{C(a=>({...a,[e]:"all"===t?void 0:t}))},onToggleFilter:(e,t)=>{C(a=>({...a,[e]:t}))},onDistanceChange:e=>{C(t=>({...t,distanceRadius:e}))},onClearAll:()=>{C({}),w("")},userLocation:v?{lat:v.latitude,lng:v.longitude}:null,locationLoading:j,hasActiveFilters:!!(k.agency||k.dietary||k.category||k.openNow||k.distanceRadius||x.trim()),isOnMapPage:!0}),!g&&(0,n.jsx)("div",{className:"px-4 mb-4",children:(0,n.jsxs)("div",{className:"text-sm text-gray-600",children:[getFilterDescription()?(0,n.jsxs)("span",{children:["Found ",S," restaurant",1!==S?"s":""," matching ",getFilterDescription()]}):(0,n.jsxs)("span",{children:["Showing ",d.length," of ",t.length," restaurants"]}),x.trim()&&(0,n.jsxs)("div",{className:"mt-1 text-xs text-jewgo-primary",children:['\uD83D\uDD0D Search active: "',x,'"']})]})}),(0,n.jsx)("div",{className:"px-4 pb-20",children:g?(0,n.jsxs)("div",{className:"flex flex-col justify-center items-center py-12",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-jewgo-primary mb-4"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"Loading restaurants..."}),v&&(0,n.jsx)("p",{className:"text-gray-500 text-xs mt-2",children:"Searching within 50 miles of your location"})]}):(0,n.jsx)(InteractiveRestaurantMap,{restaurants:d,onRestaurantSelect:e=>{let a=t.find(t=>t.id===e);y(a||null)},selectedRestaurantId:null==f?void 0:f.id,userLocation:v,mapCenter:F,className:"h-[calc(100vh-400px)]"})}),(0,n.jsx)(c.Z,{})]})}}},function(e){e.O(0,[216,349,150,744],function(){return e(e.s=5369)}),_N_E=e.O()}]);