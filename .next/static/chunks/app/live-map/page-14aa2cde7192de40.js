(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[773],{5369:function(e,t,a){Promise.resolve().then(a.bind(a,8991))},8991:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return LiveMapPage}});var n=a(7437),o=a(2265),r=a(4033),l=a(3827),s=a(7189),i=a(8101);function InteractiveRestaurantMap(e){let{restaurants:t,onRestaurantSelect:a,selectedRestaurantId:r,userLocation:l,mapCenter:s,className:i="h-96"}=e,[c,d]=(0,o.useState)(!1),[u,g]=(0,o.useState)(null),[m,p]=(0,o.useState)(null),h=(0,o.useRef)(null),x=(0,o.useRef)(null),f=(0,o.useRef)([]),w=(0,o.useRef)(null),y=(0,o.useRef)(null),[v,b]=(0,o.useState)(!1),j=t.filter(e=>{if(!e.latitude||!e.longitude)return!1;let t=parseFloat(e.latitude.toString()),a=parseFloat(e.longitude.toString());return!(isNaN(t)||isNaN(a))&&(0!==t||0!==a)&&!(t<-90)&&!(t>90)&&!(a<-180)&&!(a>180)});console.log("InteractiveRestaurantMap Debug:",{totalRestaurants:t.length,restaurantsWithCoords:j.length,userLocation:!!l,mapCenter:!!s}),(0,o.useEffect)(()=>{(()=>{if(window.google&&window.google.maps&&window.google.maps.LatLngBounds){b(!0);return}if(document.querySelector('script[src*="maps.googleapis.com"]')){let e=setInterval(()=>{window.google&&window.google.maps&&window.google.maps.LatLngBounds&&(b(!0),clearInterval(e))},100);setTimeout(()=>{clearInterval(e),window.google&&window.google.maps||g("Google Maps API failed to load")},1e4);return}let e=document.createElement("script");e.src="https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyA12xiUBIe9EJmuP8pEmWgj_Fsv0FkUiqA","&libraries=places,geometry&loading=async"),e.async=!0,e.defer=!0,e.onload=()=>{let e=setInterval(()=>{window.google&&window.google.maps&&window.google.maps.LatLngBounds&&(b(!0),clearInterval(e))},100);setTimeout(()=>{clearInterval(e),window.google&&window.google.maps||g("Google Maps API failed to initialize")},1e4)},e.onerror=()=>{g("Failed to load Google Maps API")},document.head.appendChild(e)})()},[]),(0,o.useEffect)(()=>{if(v&&h.current&&!u)try{if(!window.google||!window.google.maps||!window.google.maps.LatLngBounds){console.error("Google Maps API not fully loaded"),g("Google Maps API not fully loaded");return}if(!x.current){let e=new window.google.maps.LatLngBounds,t={lat:25.7617,lng:-80.1918};l&&(t={lat:l.latitude,lng:l.longitude},e.extend(new window.google.maps.LatLng(l.latitude,l.longitude))),j.length>0&&j.forEach(t=>{void 0!==t.latitude&&void 0!==t.longitude&&e.extend(new window.google.maps.LatLng(t.latitude,t.longitude))});let a=new window.google.maps.Map(h.current,{center:t,zoom:l?14:10,mapTypeId:window.google.maps.MapTypeId.ROADMAP,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"simplified"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"simplified"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#e3f2fd"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#e8f5e8"}]}],zoomControl:!0,mapTypeControl:!1,scaleControl:!0,streetViewControl:!1,rotateControl:!1,fullscreenControl:!0,gestureHandling:"cooperative"});x.current=a,y.current=new window.google.maps.InfoWindow({disableAutoPan:!1,maxWidth:300}),s?(a.setCenter(s),a.setZoom(16)):l?(a.setCenter({lat:l.latitude,lng:l.longitude}),a.setZoom(14)):j.length>0&&a.fitBounds(e),d(!0)}}catch(e){console.error("Error initializing map:",e),g("Failed to initialize map")}},[v,u,l,s]),(0,o.useEffect)(()=>{if(x.current&&c&&l)try{let e=x.current;w.current&&w.current.setMap(null);let t=new window.google.maps.LatLng(l.latitude,l.longitude),a={url:"data:image/svg+xml;charset=UTF-8,".concat(encodeURIComponent('\n          <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <circle cx="16" cy="16" r="8" fill="#4285F4" stroke="white" stroke-width="3"/>\n            <circle cx="16" cy="16" r="4" fill="white"/>\n            <circle cx="16" cy="16" r="12" fill="#4285F4" opacity="0.3"/>\n          </svg>\n        ')),scaledSize:new window.google.maps.Size(32,32),anchor:new window.google.maps.Point(16,16)};w.current=new window.google.maps.Marker({position:t,map:e,icon:a,title:"Your Location",zIndex:1e3}),w.current.addListener("click",()=>{if(e.panTo(t),e.setZoom(10),y.current){let t='\n            <div class="p-3 max-w-xs">\n              <div class="flex items-center space-x-2">\n                <div class="w-3 h-3 bg-blue-500 rounded-full"></div>\n                <h3 class="font-semibold text-gray-900 text-sm">Your Location</h3>\n              </div>\n              <p class="text-gray-600 text-xs mt-1">\n                '.concat(l.latitude.toFixed(6),", ").concat(l.longitude.toFixed(6),"\n              </p>\n              ").concat(l.accuracy?'\n                <p class="text-gray-500 text-xs mt-1">\n                  Accuracy: \xb1'.concat(Math.round(l.accuracy)," meters\n                </p>\n              "):"","\n            </div>\n          ");y.current.setContent(t),y.current.open(e,w.current)}})}catch(e){console.error("Error updating user location marker:",e)}},[l,c]),(0,o.useEffect)(()=>{if(x.current&&c&&l)try{let e=x.current;console.log("Updating map center to user location:",l),e.panTo({lat:l.latitude,lng:l.longitude}),e.setZoom(14)}catch(e){console.error("Error updating map center:",e)}},[l,c]),(0,o.useEffect)(()=>{if(console.log("mapCenter prop changed:",s),console.log("mapLoaded:",c),console.log("mapInstanceRef.current:",!!x.current),!x.current||!c||!s){console.log("Skipping map center update - conditions not met");return}try{let e=x.current;console.log("Updating map center from URL parameters:",s),e.panTo(s),e.setZoom(16),console.log("Map center updated successfully")}catch(e){console.error("Error updating map center from URL parameters:",e)}},[s,c]),(0,o.useEffect)(()=>{if(x.current&&c&&0!==j.length)try{let e=x.current;f.current.forEach(e=>e.setMap(null)),f.current=[],j.forEach(t=>{let n;if(void 0===t.latitude||void 0===t.longitude)return;let o=new window.google.maps.LatLng(t.latitude,t.longitude),s=r===t.id,i=null;if(l){let e=(t.latitude-l.latitude)*Math.PI/180,a=(t.longitude-l.longitude)*Math.PI/180,n=Math.sin(e/2)*Math.sin(e/2)+Math.cos(l.latitude*Math.PI/180)*Math.cos(t.latitude*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);i=3959*(2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n)))}let c=(e=>{switch(null==e?void 0:e.toLowerCase()){case"meat":return"#dc2626";case"dairy":return"#2563eb";case"pareve":return"#059669";default:return"#4b5563"}})(t.kosher_category),d=s?"#FFD700":c;if(window.google.maps.marker&&window.google.maps.marker.AdvancedMarkerElement)try{let a=new window.google.maps.marker.PinElement({background:d,borderColor:"#000000",glyphColor:"#FFFFFF",scale:1.5});n=new window.google.maps.marker.AdvancedMarkerElement({position:o,map:e,content:a.element,title:t.name})}catch(r){console.warn("AdvancedMarkerElement failed, falling back to regular Marker:",r);let a={url:"data:image/svg+xml;charset=UTF-8,".concat(encodeURIComponent('\n                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                  <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z" \n                        fill="'.concat(d,'" \n                        stroke="#000000" \n                        stroke-width="1.5"/>\n                  <circle cx="12" cy="9" r="2.5" fill="white"/>\n                  <circle cx="12" cy="9" r="1.5" fill="').concat(d,'"/>\n                </svg>\n              '))),scaledSize:new window.google.maps.Size(32,32),anchor:new window.google.maps.Point(12,24)};n=new window.google.maps.Marker({position:o,map:e,icon:a,title:t.name})}else{let a={url:"data:image/svg+xml;charset=UTF-8,".concat(encodeURIComponent('\n              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z" \n                      fill="'.concat(d,'" \n                      stroke="#000000" \n                      stroke-width="1.5"/>\n                <circle cx="12" cy="9" r="2.5" fill="white"/>\n                <circle cx="12" cy="9" r="1.5" fill="').concat(d,'"/>\n              </svg>\n            '))),scaledSize:new window.google.maps.Size(32,32),anchor:new window.google.maps.Point(12,24)};n=new window.google.maps.Marker({position:o,map:e,icon:a,title:t.name})}n.addListener("click",()=>{if(console.log("Marker clicked:",t.name),p(t),null==a||a(t.id),y.current){let a=createInfoWindowContent(t,i);y.current.setContent(a),y.current.open(e,n)}}),f.current.push(n)})}catch(e){console.error("Error updating markers:",e)}},[j,r,c,l]);let getSafeImageUrl=e=>{var t;let a=null===(t=e.image_url)||void 0===t?void 0:t.includes("maps.googleapis.com/maps/api/place/photo");if(a){let t="AIzaSyA12xiUBIe9EJmuP8pEmWgj_Fsv0FkUiqA";if(t)try{let a=new URL(e.image_url),n=a.searchParams.get("photo_reference"),o=a.searchParams.get("maxwidth")||"400";if(n)return"https://maps.googleapis.com/maps/api/place/photo?maxwidth=".concat(o,"&photo_reference=").concat(n,"&key=").concat(t)}catch(e){console.error("Error parsing Google Places URL:",e)}return null}return e.image_url},createInfoWindowContent=(e,t)=>{let a=getSafeImageUrl(e);return'\n      <div class="p-3 max-w-xs relative">\n        <button onclick="this.parentElement.parentElement.parentElement.close()" \n                class="absolute top-2 right-2 text-gray-400 hover:text-gray-600 text-lg font-bold leading-none">\n          \xd7\n        </button>\n        <div class="flex items-start space-x-3">\n          '.concat(a?'\n            <img src="'.concat(a,'" alt="').concat(e.name,'" \n                 class="w-16 h-12 object-cover rounded-lg flex-shrink-0"\n                 loading="lazy" />\n          '):'\n            <div class="w-16 h-12 bg-gray-200 rounded-lg flex-shrink-0 flex items-center justify-center">\n              <span class="text-gray-400 text-xs">No Image</span>\n            </div>\n          ','\n          <div class="flex-1 min-w-0">\n            <h3 class="font-semibold text-gray-900 text-sm leading-tight mb-1">').concat(e.name,'</h3>\n            <p class="text-gray-600 text-xs mb-1">').concat(e.address,"</p>\n            ").concat(null!=t?'\n              <p class="text-blue-600 text-xs font-medium mb-1">\uD83D\uDCCD '.concat(t.toFixed(1)," miles away</p>\n            "):"","\n            ").concat(e.certifying_agency?'\n              <span class="inline-block bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded-full mb-1">\n                '.concat(e.certifying_agency,"\n              </span>\n            "):"","\n            ").concat(e.kosher_category?'\n              <span class="inline-block '.concat("meat"===e.kosher_category?"bg-red-100 text-red-800":"dairy"===e.kosher_category?"bg-blue-100 text-blue-800":"pareve"===e.kosher_category?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",' text-xs px-2 py-1 rounded-full mb-1">\n                ').concat(e.kosher_category,"\n              </span>\n            "):"","\n            ").concat(e.avg_price?'\n              <p class="text-green-600 text-xs font-medium">'.concat(e.avg_price,"</p>\n            "):"",'\n          </div>\n        </div>\n        <div class="mt-3 pt-2 border-t border-gray-200">\n          <a href="/restaurant/').concat(e.id,'" \n             class="text-blue-600 hover:text-blue-800 text-xs font-medium">\n            View Details →\n          </a>\n        </div>\n      </div>\n    ')};return v||u?u?(0,n.jsx)("div",{className:"bg-gray-100 rounded-lg flex items-center justify-center ".concat(i),children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-red-500 text-4xl mb-4",children:"⚠️"}),(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Map Error"}),(0,n.jsx)("p",{className:"text-gray-600 mb-4",children:u})]})}):0===j.length?(0,n.jsx)("div",{className:"bg-gray-100 rounded-lg flex items-center justify-center ".concat(i),children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-gray-400 text-4xl mb-4",children:"\uD83D\uDDFA️"}),(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Location Data"}),(0,n.jsx)("p",{className:"text-gray-600",children:"No restaurants with location data available"})]})}):(0,n.jsxs)("div",{className:"relative bg-white rounded-lg shadow-lg overflow-hidden ".concat(i),children:[(0,n.jsx)("div",{ref:h,className:"w-full h-full"}),(0,n.jsx)("div",{className:"absolute bottom-4 left-4 bg-white/95 backdrop-blur-sm rounded-lg px-3 py-2 shadow-lg",children:(0,n.jsxs)("div",{className:"text-xs font-medium text-gray-700",children:[j.length," restaurants",l&&(0,n.jsx)("span",{className:"text-blue-600 ml-2",children:"\uD83D\uDCCD Your location"})]})}),(0,n.jsxs)("div",{className:"absolute top-4 left-4 bg-white/95 backdrop-blur-sm rounded-lg px-3 py-2 shadow-lg",children:[(0,n.jsx)("div",{className:"text-xs font-medium text-gray-700 mb-2",children:"Kosher Types:"}),(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500"}),(0,n.jsx)("span",{className:"text-xs text-gray-600",children:"Meat"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),(0,n.jsx)("span",{className:"text-xs text-gray-600",children:"Dairy"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-500"}),(0,n.jsx)("span",{className:"text-xs text-gray-600",children:"Pareve"})]})]})]}),l&&(0,n.jsx)("div",{className:"absolute top-4 right-4",children:(0,n.jsx)("button",{onClick:()=>{x.current&&l&&(x.current.panTo(new window.google.maps.LatLng(l.latitude,l.longitude)),x.current.setZoom(10))},className:"bg-white/95 backdrop-blur-sm rounded-lg p-2 shadow-lg hover:bg-white transition-colors",title:"Center on your location",children:(0,n.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})})})})]}):(0,n.jsx)("div",{className:"bg-gray-100 rounded-lg flex items-center justify-center ".concat(i),children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-jewgo-primary mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Loading interactive map..."})]})})}var c=a(9884),d=a(3050);function LiveMapPage(){let e=(0,r.useSearchParams)(),[t,a]=(0,o.useState)([]),[u,g]=(0,o.useState)([]),[m,p]=(0,o.useState)(!0),[h,x]=(0,o.useState)(null),[f,w]=(0,o.useState)(""),[y,v]=(0,o.useState)(null),[b,j]=(0,o.useState)(null),[L,N]=(0,o.useState)(!1),[M,k]=(0,o.useState)(null),[C,D]=(0,o.useState)({}),[E,F]=(0,o.useState)(null),[S,I]=(0,o.useState)("eatery");(0,o.useEffect)(()=>{let t=e.get("lat"),a=e.get("lng"),n=e.get("name");if(t&&a){let e=parseFloat(t),o=parseFloat(a);if(!isNaN(e)&&!isNaN(o)&&e>=-90&&e<=90&&o>=-180&&o<=180){if(F({lat:e,lng:o}),n){let e=decodeURIComponent(n);w(e)}}else console.warn("Invalid coordinates in URL parameters:",{lat:t,lng:a,latitude:e,longitude:o})}},[e]),(0,o.useEffect)(()=>{R()},[]),(0,o.useEffect)(()=>{getUserLocation()},[]),(0,o.useEffect)(()=>{b&&R()},[b]),(0,o.useEffect)(()=>{console.log("Live map useEffect triggered - updateDisplayedRestaurants"),console.log("Live map allRestaurants count:",t.length),updateDisplayedRestaurants()},[t,f,C,b]);let R=(0,o.useCallback)(async()=>{try{p(!0),x(null);let e="".concat("https://jewgo.onrender.com","/api/restaurants");if(b){let t=f.trim()?"".concat(e,"?limit=1000"):"".concat(e,"?limit=200&lat=").concat(b.latitude,"&lng=").concat(b.longitude,"&radius=50");console.log("Live map fetching from:",t);let n=await fetch(t);if(!n.ok)throw Error("Failed to fetch restaurants");let o=await n.json();if(o.success&&o.data)console.log("Live map API returned restaurants:",o.data.length),console.log("Live map setting allRestaurants:",o.data.length),a(o.data);else throw Error(o.error||"Failed to fetch restaurants")}else{let t=await fetch("".concat(e,"?limit=1000"));if(!t.ok)throw Error("Failed to fetch restaurants");let n=await t.json();if(n.success&&n.data)console.log("Live map API returned restaurants:",n.data.length),console.log("Live map setting allRestaurants:",n.data.length),a(n.data);else throw Error(n.error||"Failed to fetch restaurants")}}catch(e){console.error("Error fetching restaurants:",e)}finally{p(!1)}},[b,f]),getUserLocation=()=>{if(!navigator.geolocation){k("Geolocation is not supported by this browser");return}N(!0),k(null),navigator.geolocation.getCurrentPosition(e=>{let t={latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy};j(t),N(!1)},e=>{let t=getLocationErrorMessage(e.code);k(t),N(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})},getLocationErrorMessage=e=>{switch(e){case 1:return"Location access denied. Please enable location services.";case 2:return"Location unavailable. Please try again.";case 3:return"Location request timed out. Please try again.";default:return"Unable to get your location. Please try again."}},calculateDistance=(e,t,a,n)=>{let o=(a-e)*Math.PI/180,r=(n-t)*Math.PI/180,l=Math.sin(o/2)*Math.sin(o/2)+Math.cos(e*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 3959*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))},updateDisplayedRestaurants=()=>{console.log("Live map updateDisplayedRestaurants called with:",{allRestaurantsCount:t.length,searchQuery:f,activeFilters:C});let e=[...t];if(f.trim()){let a=f.toLowerCase();console.log("Live map search query:",a),console.log("Live map first few restaurant names:",t.slice(0,3).map(e=>e.name)),e=e.filter(e=>{let t=[e.name,e.address,e.city,e.state,e.certifying_agency,e.kosher_category,e.listing_type,e.phone_number,e.avg_price].filter(Boolean).map(e=>null==e?void 0:e.toLowerCase()),n=t.some(e=>null==e?void 0:e.includes(a));return(e.name.toLowerCase().includes("17")||e.name.toLowerCase().includes("restaurant"))&&console.log("Live map checking restaurant:",e.name,"matches:",n),n})}if(C.agency&&"all"!==C.agency&&(e=e.filter(e=>{var t,a;return"Diamond K"===C.agency?"Diamond K"===e.certifying_agency:(null===(t=e.certifying_agency)||void 0===t?void 0:t.toUpperCase())===(null===(a=C.agency)||void 0===a?void 0:a.toUpperCase())})),C.dietary&&(e=e.filter(e=>{var t;let a=(null===(t=e.kosher_category)||void 0===t?void 0:t.toLowerCase())||"";return"meat"===C.dietary?"meat"===a:"dairy"===C.dietary?"dairy"===a:"pareve"===C.dietary&&"pareve"===a})),C.category&&"all"!==C.category&&(e=e.filter(e=>{var t,a;let n=(null===(t=e.listing_type)||void 0===t?void 0:t.toLowerCase())||"";return n===(null===(a=C.category)||void 0===a?void 0:a.toLowerCase())})),C.distanceRadius&&b&&(e=e.filter(e=>{let t=calculateDistance(b.latitude,b.longitude,parseFloat(String(e.latitude)||"0"),parseFloat(String(e.longitude)||"0"));return t<=C.distanceRadius})),C.openNow){let t=new Date;t.getDay(),t.getHours(),t.getMinutes(),e=e.filter(e=>e.hours_of_operation&&""!==e.hours_of_operation.trim())}b&&e.sort((e,t)=>{let a=calculateDistance(b.latitude,b.longitude,parseFloat(String(e.latitude)||"0"),parseFloat(String(e.longitude)||"0")),n=calculateDistance(b.latitude,b.longitude,parseFloat(String(t.latitude)||"0"),parseFloat(String(t.longitude)||"0"));return a-n}),console.log("Live map setting displayedRestaurants:",e.length),g(e)},getFilterDescription=()=>{let e=[];return C.agency&&e.push(C.agency),C.dietary&&e.push(C.dietary),C.category&&e.push(C.category),C.openNow&&e.push("Open Now"),C.distanceRadius&&e.push("".concat(C.distanceRadius," miles")),f.trim()&&e.push('"'.concat(f,'"')),e.join(" + ")},P=u.length;return(0,n.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,n.jsx)(l.Z,{}),(0,n.jsx)("div",{className:"px-4 py-4",children:(0,n.jsx)(s.Z,{onSearch:e=>{w(e)}})}),(0,n.jsx)(d.Z,{activeTab:S,onTabChange:e=>{I(e),w("")}}),(0,n.jsxs)("div",{className:"px-4 mb-3",children:[L&&(0,n.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-blue-600 bg-blue-50 px-3 py-2 rounded-lg",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),(0,n.jsx)("span",{children:"Getting your location..."})]}),M&&(0,n.jsxs)("div",{className:"flex items-center justify-between text-sm text-red-600 bg-red-50 px-3 py-2 rounded-lg",children:[(0,n.jsx)("span",{children:M}),(0,n.jsx)("button",{onClick:getUserLocation,className:"text-red-800 hover:text-red-900 font-medium",children:"Retry"})]}),b&&(0,n.jsxs)("div",{className:"flex items-center justify-between text-sm text-green-600 bg-green-50 px-3 py-2 rounded-lg",children:[(0,n.jsx)("span",{children:"\uD83D\uDCCD Location found! Showing nearby restaurants"}),(0,n.jsx)("button",{onClick:getUserLocation,className:"text-green-800 hover:text-green-900 font-medium text-xs",children:"Refresh"})]}),!b&&!L&&!M&&(0,n.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600 bg-gray-50 px-3 py-2 rounded-lg",children:[(0,n.jsx)("span",{children:"\uD83D\uDCCD Enable location to see nearby restaurants"}),(0,n.jsx)("button",{onClick:getUserLocation,className:"text-blue-600 hover:text-blue-700 font-medium text-xs",children:"Get Location"})]})]}),(0,n.jsx)(i.Z,{onShowFilters:()=>{},onShowMap:()=>{window.location.href="/"},onAddEatery:()=>{window.location.href="/add-eatery"},activeFilters:C,onFilterChange:(e,t)=>{D(a=>({...a,[e]:"all"===t?void 0:t}))},onToggleFilter:(e,t)=>{D(a=>({...a,[e]:t}))},onDistanceChange:e=>{D(t=>({...t,distanceRadius:e}))},onClearAll:()=>{D({}),w("")},userLocation:b?{lat:b.latitude,lng:b.longitude}:null,locationLoading:L,hasActiveFilters:!!(C.agency||C.dietary||C.category||C.openNow||C.distanceRadius||f.trim()),isOnMapPage:!0}),!m&&(0,n.jsx)("div",{className:"px-4 mb-4",children:(0,n.jsxs)("div",{className:"text-sm text-gray-600",children:[getFilterDescription()?(0,n.jsxs)("span",{children:["Found ",P," restaurant",1!==P?"s":""," matching ",getFilterDescription()]}):(0,n.jsxs)("span",{children:["Showing ",u.length," of ",t.length," restaurants"]}),f.trim()&&(0,n.jsxs)("div",{className:"mt-1 text-xs text-jewgo-primary",children:['\uD83D\uDD0D Search active: "',f,'"']})]})}),(0,n.jsx)("div",{className:"px-4 pb-20",children:m?(0,n.jsxs)("div",{className:"flex flex-col justify-center items-center py-12",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-jewgo-primary mb-4"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"Loading restaurants..."}),b&&(0,n.jsx)("p",{className:"text-gray-500 text-xs mt-2",children:"Searching within 50 miles of your location"})]}):(0,n.jsx)(InteractiveRestaurantMap,{restaurants:u,onRestaurantSelect:e=>{let a=t.find(t=>t.id===e);v(a||null)},selectedRestaurantId:null==y?void 0:y.id,userLocation:b,mapCenter:E,className:"h-[calc(100vh-400px)]"})}),(0,n.jsx)(c.Z,{})]})}}},function(e){e.O(0,[216,705,189,101,744],function(){return e(e.s=5369)}),_N_E=e.O()}]);